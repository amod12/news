<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />

    <title>Results</title>
    <style>
      *{
        padding: 0;
        margin: 0;
        box-sizing: border-box;
      }
      .card-deck {
        border-radius: 8px;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
        margin-bottom: 20px;
        padding: 15px;
      }
      #dvMap {
        height: 100%;
        width: 75%;
        margin: 50px auto;
        border-radius: 8px;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
      }
    </style>
  </head>
  <body>
    <header style="background-color: black; display: flex; align-items: center; width: 100%;">
      <nav class="container" style="display: flex; justify-content: space-between; color: white; align-items: center; flex-wrap: wrap;">
        <h2><a href="{% url 'home' %}" style="text-decoration: none; color: white;">News site</a></h2>
        <h2>
          <div
          class="main-title"
          style="
            text-shadow: 0 9px 25px rgba(0, 0, 0, 0.15);
            line-height: 1.05;
            margin-bottom: 24px;
            left: 280px;
            top: 120px;
          "
        >
        </div>
    
        <form
          action="/get-recommendation"
          method="post"
          style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap;"
        >
          {% csrf_token %}
          <input type="text"
            name="user_description"
            placeholder="Search news here"
          
            maxlength="500"
            style="
              opacity: 0.8;
              width: 300px;
              height: 35px;
              padding: 10px 20px;
              box-sizing: border-box;
              border: 2px solid #ccc;
              border-radius: 4px;
              background-color: aliceblue;
              font-size: 16px;
              resize: none;
            "
          ></input
          ><br />
          <button
          class="btn btn-lg btn-success"
          style="height: 35px; padding: 10px; display: flex; align-items: center;"
            type="submit"
          >
            Submit
          </button>
        </form>
        </h2>
      </nav>
    </header>
    <div
      style="
        font-size: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      "
    >
      Results
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    -->
    <div class="vstack">
      <div
        class="card mb-3 w-75"
        style="
          margin: 0 auto;
          border-radius: 8px;
          box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px,
            rgba(0, 0, 0, 0.3) 0px 30px 60px -30px;
        "
      >
      {% if query%}
      <p> {{query}}</p>
      {%endif%}
        {% for news in newss %}

        <div class="card-deck"  style="display: flex; gap: 20px; flex-wrap: wrap;">
          <a href="{% url 'detail_page' news.id %}">
          <img
          src="{{news.image.url}}"
          class="card-img-top mt-3 w-50"
            style="max-width: 1000px; max-height: 200px"
          />
          </a>
          <a href="{% url 'detail_page' news.id %}" style="text-decoration: none; color: black;">
          <div class="card-body" style="width: 500px;">
            <!-- <h2 class="card-title">{{news.name}}</h2> -->
            <h3 class="card-text">{{news.title}}</h3>
            <p class="card-text">{{news.description}}</p>
          </div>
          </a>
        </div>

 {% endfor %}
      </div>
    </div>
    <footer style="background-color: black; display: flex; align-items: center; color:  white; justify-content: center; font-weight: bold; height: 80px;">
      <p>
        Lorem, ipsum  tempora nostrum impedit voluptatem harum, animi non. Copyright reserved: Yarki
      </p>
    </footer>
   
    <!-- Replace the value of the key parameter with your own API key. -->
    <style>
      #dvMap {
        height: 30%;
      }

      /* Optional: Makes the sample page fill the window. */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script>
      //      var markers = [
      //      {% for place in places %}
      //          {
      //              "timestamp": '{{place.name}}',
      //              "latitude": '{{place.lat}}',
      //              "longitude": '{{place.long}}',
      //              "description": 'This is description'
      //          },
      //      {% endfor %}
      // ];
      window.onload = function() {
        var mapOptions = {
          center: new google.maps.LatLng(markers[0].latitude, markers[0].longitude),
          zoom: 35,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("dvMap"), mapOptions);
        var infoWindow = new google.maps.InfoWindow();
        var lat_lng = new Array();
        var latlngbounds = new google.maps.LatLngBounds();
        for (i = 0; i < markers.length; i++) {
          var data = markers[i]
          var myLatlng = new google.maps.LatLng(data.latitude, data.longitude);
          lat_lng.push(myLatlng);
          var marker = new google.maps.Marker({
            position: myLatlng,
            map: map,
            title: data.timestamp,
          });
          // console.log(i)

          latlngbounds.extend(marker.position);
          (function(marker, data) {
            google.maps.event.addListener(marker, "click", function(e) {
              infoWindow.setContent(data.timestamp);
              infoWindow.open(map, marker);
            });
          })(marker, data);
        }
        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds);

        //***********ROUTING****************//


        //Initialize the Direction Service
        var service = new google.maps.DirectionsService();




        //Loop and Draw Path Route between the Points on MAP
        for (var i = 0; i < lat_lng.length; i++) {
          if ((i + 1) < lat_lng.length) {
            var src = lat_lng[i];
            var des = lat_lng[i + 1];
            // path.push(src);

            service.route({
              origin: src,
              destination: des,
              travelMode: google.maps.DirectionsTravelMode.WALKING
            }, function(result, status) {
              if (status == google.maps.DirectionsStatus.OK) {

                //Initialize the Path Array
                var path = new google.maps.MVCArray();
                //Set the Path Stroke Color
                var poly = new google.maps.Polyline({
                  map: map,
                  strokeColor: '#4986E7'
                });
                poly.setPath(path);
                for (var i = 0, len = result.routes[0].overview_path.length; i < len; i++) {
                  path.push(result.routes[0].overview_path[i]);
                }
              }
            });
          }
        }
      }
    </script>

    
  </body>
</html>
